<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #box1,
        #box2 {
            float: left;
            position: relative;
            width: 400px;
            height: 400px;
            border: 1px solid sandybrown;
            margin: 80px;
            overflow: hidden;
        }

        #box1 img {

            width: 100%;
            height: 100%;
        }

        #box2 img {
            position: absolute;
            top: 0;
            left: 0;
            width: 800px;
            height: 800px;
        }

        #mask {
            position: absolute;
            left: 0;
            top: 0;
            background: rgba(223, 247, 89, 0.5);
            cursor: pointer;
            display: none;
        }
        #box2 {
            display: none;
        }
    </style>
</head>

<body>
    <div id="box1">
        <img src="./iphone.jpg" alt="" id="minImg">
        <div id="mask" style="width:200px; height: 200px;"></div>
    </div>
    <div id="box2">
        <img src="./iphone.jpg" alt="" id="maxImg">
    </div>
    <script>
        const $ = selector => document.querySelector(selector);

        // 获取元素
        const box1 = $('#box1');
        const mask = $('#mask');
        const maxImg = $('#maxImg');

        // 获取遮罩层宽高
        let { width, height } = mask.style;
        width = parseFloat(width);
        height = parseFloat(height);
        // 监听鼠标在box1元素上的移动
        // pageX 相对于页面左边边缘的距离
        // pageY 相对于页面上边边缘的距离
        // 最小坐标
        const minL = 0;
        const minT = 0;
        // 最大坐标
        let maxL = box1.clientWidth - width;
        let maxT = box1.clientHeight - height;
        window.onresize = function () {
            maxL = box1.clientWidth - width;
            maxT = box1.clientHeight - height;
        }
        box1.onmousemove = function (event) {
            // 计算出鼠标在元素内 坐标x、y
            // 减去mask自身宽度和高度的一半 目的让鼠标坐标 作为mask的中心点
            let {
                pageX,
                pageY
            } = event;
            let l = pageX - this.offsetLeft - width / 2;
            let t = pageY - this.offsetTop - height / 2;
            l < minL && (l = minL);
            t < minT && (t = minT);
            l > maxL && (l = maxL);
            t > maxT && (t = maxT);
            
            mask.style.left = l + 'px';
            mask.style.top = t + 'px';
            // 控制大图和遮罩层相反方向移动
            maxImg.style.left = -l * 2 + 'px';
            maxImg.style.top= -t * 2 + 'px';
        }

        // 控制box1的滑入滑出
        box1.onmouseenter = function () {
            box2.style.display = mask.style.display = 'block';
        }
        box1.onmouseleave = function () {
            box2.style.display = mask.style.display = 'none';
        }

    </script>
</body>

</html>